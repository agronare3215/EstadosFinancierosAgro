<!doctype html>
<html lang="es" class="h-full">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0f172a" />
    <title>Agronare â€¢ Estados Financieros</title>

    <!-- PWA -->
    <link rel="manifest" href="/manifest.json" />

    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="apple-touch-icon" href="/icons/icon-180.png" />

    <!-- Si usas PostCSS/Tailwind en build puedes quitar el CDN en producciÃ³n -->
    <link rel="stylesheet" href="/src/style.css" />

    <!-- Estilos propios (estÃ¡n en src/) -->
    <link rel="stylesheet" href="/src/style.css" />

    <!-- LibrerÃ­as usadas por main.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>

<body class="h-full bg-slate-100 text-slate-900 dark:bg-slate-900 dark:text-slate-100">
    <a href="#main" class="sr-only focus:not-sr-only">Saltar al contenido</a>

    <!-- TOP BAR -->
    <nav class="sticky top-0 z-20 border-b bg-white/70 backdrop-blur dark:bg-slate-900/70">
        <div class="mx-auto max-w-6xl px-4 py-2 flex items-center gap-3">
            <img id="companyLogoImg" src="" alt="Logo de la compaÃ±Ã­a" class="h-9 w-9 rounded-md border" />
            <div class="text-lg font-semibold">Agronare â€¢ Estados Financieros</div>
            <div class="ml-auto flex items-center gap-2">
                <button id="btn-toggle-theme" class="px-3 py-1 rounded border text-sm" aria-pressed="false">ðŸŒ™
                    Oscuro</button>
                <span id="app-status" class="sr-only" aria-live="polite"></span>
            </div>
        </div>
    </nav>

    <main id="main" class="mx-auto max-w-6xl px-4 py-6">
        <!-- (aquÃ­ va exactamente tu contenido form que usas; lo dejÃ© igual al anterior) -->
        <!-- ENCABEZADO -->
        <section class="bg-white dark:bg-slate-800 rounded-lg border p-4 mb-4">
            <div class="grid gap-3 md:grid-cols-4">
                <label class="block">
                    <span class="text-sm">CompaÃ±Ã­a</span>
                    <input id="companyName" type="text" class="input-field w-full" value="Agronare S.A. de C.V."
                        placeholder="RazÃ³n social" />
                </label>
                <label class="block">
                    <span class="text-sm">Fecha de reporte</span>
                    <input id="reportDate" type="date" class="input-field w-full" title="Fecha de reporte" />
                </label>
                <label class="block">
                    <span class="text-sm">Moneda</span>
                    <select id="currencySelect" class="input-field w-full" title="Moneda">
                        <option value="MXN" selected>MXN</option>
                        <option value="USD">USD</option>
                        <option value="EUR">EUR</option>
                    </select>
                </label>
                <label class="block">
                    <span class="text-sm">Logo (PNG/JPG/SVG)</span>
                    <label for="companyLogoFile" class="sr-only">Subir logo</label>
                    <input id="companyLogoFile" type="file" accept=".png,.jpg,.jpeg,.svg" class="w-full"
                        aria-label="Subir logo de la compaÃ±Ã­a" />
                </label>
            </div>
            <div class="mt-3">
                <label class="block">
                    <span class="text-sm">Notas del reporte</span>
                    <textarea id="reportNotes" rows="2" class="input-field w-full"
                        placeholder="Notas del reporte (opcional)"></textarea>
                </label>
            </div>
        </section>

        <!-- ACCIONES -->
        <section class="bg-white dark:bg-slate-800 rounded-lg border p-4 mb-4">
            <div class="flex flex-wrap gap-2">
                <button id="btn-preview" class="px-3 py-2 rounded border">Actualizar</button>
                <button id="btn-save-local" class="px-3 py-2 rounded border">Guardar en navegador</button>
                <button id="btn-clear-local" class="px-3 py-2 rounded border">Borrar guardado</button>
                <button id="btn-reset" class="px-3 py-2 rounded border">Reiniciar</button>

                <button id="btn-save-json" class="px-3 py-2 rounded border">Descargar JSON</button>

                <label for="file-load" class="sr-only">Seleccionar archivo JSON</label>
                <input id="file-load" type="file" class="hidden" accept=".json" aria-hidden="true" />
                <button id="btn-load-json" class="px-3 py-2 rounded border" aria-controls="file-load">Cargar
                    JSON</button>

                <button id="btn-export-xlsx" class="px-3 py-2 rounded border">Exportar Excel</button>
                <button id="btn-export-pdf" class="px-3 py-2 rounded border">Exportar PDF</button>

                <button id="btn-gemini-analysis" class="ml-auto px-3 py-2 rounded border">AnÃ¡lisis con IA</button>
            </div>
        </section>

        <!-- (el resto de tu HTML: opciones PDF, tabs, paneles, etc.) -->
        <!-- ... mantuve exactamente el HTML que ya tenÃ­as (por longitud no lo repito todo otra vez) ... -->
        <!-- Si quieres que te lo pegue completo otra vez lo hago, pero ya estÃ¡ en tu proyecto. -->
    </main>

    <!-- LOADER -->
    <div id="loader" class="hidden fixed inset-0 bg-black/20 backdrop-blur-sm" aria-hidden="true">
        <div class="w-full h-full flex items-center justify-center">
            <div class="px-4 py-3 rounded-lg bg-white dark:bg-slate-800 border shadow">
                Generandoâ€¦
            </div>
        </div>
    </div>

    <!-- JS principal (mÃ³dulo) -->
    <script type="module" src="/src/main.js"></script>

    <!-- Importador CSV: fallback si no estÃ¡ en main.js -->
    <script>
        const trial = document.getElementById('trial-file');
        if (trial) {
            trial.addEventListener('change', (e) => {
                if (typeof importTrialBalanceCSV === 'function') {
                    importTrialBalanceCSV(e.target.files[0]);
                    e.target.value = '';
                }
            });
        }
    </script>
</body>

</html>